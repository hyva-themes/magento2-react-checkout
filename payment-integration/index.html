
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/img/hyva-logo-360.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.0">
    
    
      
        <title>Payment Integration - Hyvä Themes - React Checkout</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#payment-integration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Hyvä Themes - React Checkout" class="md-header__button md-logo" aria-label="Hyvä Themes - React Checkout" data-md-component="logo">
      
  <img src="../assets/img/hyva-logo-360.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hyvä Themes - React Checkout
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Payment Integration
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Hyvä Themes - React Checkout" class="md-nav__button md-logo" aria-label="Hyvä Themes - React Checkout" data-md-component="logo">
      
  <img src="../assets/img/hyva-logo-360.png" alt="logo">

    </a>
    Hyvä Themes - React Checkout
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../customize/" class="md-nav__link">
        How to customize
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../build/" class="md-nav__link">
        How can build
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../i18n/" class="md-nav__link">
        Internationalization
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Payment Integration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Payment Integration
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#payment-supports" class="md-nav__link">
    Payment Supports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#payment-configurations-and-its-usage" class="md-nav__link">
    Payment Configurations and Its Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-payment-renderer" class="md-nav__link">
    Custom Payment Renderer
  </a>
  
    <nav class="md-nav" aria-label="Custom Payment Renderer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-create-my-own-custom-payment-renderer" class="md-nav__link">
    How To Create My Own Custom Payment Renderer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-a-custom-payment-renderer-repo-with-hyva-react-checkout" class="md-nav__link">
    How To Use A Custom Payment Renderer Repo With Hyvä React Checkout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-custom-payment-renderer-works" class="md-nav__link">
    How Custom Payment Renderer Works
  </a>
  
    <nav class="md-nav" aria-label="How Custom Payment Renderer Works">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-custom-payment-renderer-interacts-on-place-order-action" class="md-nav__link">
    How Custom Payment Renderer Interacts on Place Order Action
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-payment-method-best-practices" class="md-nav__link">
    Custom Payment Method Best Practices
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../env_variables/" class="md-nav__link">
        React app configurations
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          New Version - 2.0
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="New Version - 2.0" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          New Version - 2.0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2.0/new_version/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2.0/installation/" class="md-nav__link">
        How to use it
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2.0/multi-theme/" class="md-nav__link">
        Multiple themes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2.0/major-changes/" class="md-nav__link">
        Major changes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../faqs/" class="md-nav__link">
        FAQs
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#payment-supports" class="md-nav__link">
    Payment Supports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#payment-configurations-and-its-usage" class="md-nav__link">
    Payment Configurations and Its Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-payment-renderer" class="md-nav__link">
    Custom Payment Renderer
  </a>
  
    <nav class="md-nav" aria-label="Custom Payment Renderer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-create-my-own-custom-payment-renderer" class="md-nav__link">
    How To Create My Own Custom Payment Renderer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-a-custom-payment-renderer-repo-with-hyva-react-checkout" class="md-nav__link">
    How To Use A Custom Payment Renderer Repo With Hyvä React Checkout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-custom-payment-renderer-works" class="md-nav__link">
    How Custom Payment Renderer Works
  </a>
  
    <nav class="md-nav" aria-label="How Custom Payment Renderer Works">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-custom-payment-renderer-interacts-on-place-order-action" class="md-nav__link">
    How Custom Payment Renderer Interacts on Place Order Action
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-payment-method-best-practices" class="md-nav__link">
    Custom Payment Method Best Practices
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="payment-integration">Payment Integration</h1>
<p>In Hyvä React Checkout, the payment options will be shown as radio inputs by default. You can choose the option and place the order, and everything works out of the box.</p>
<p>But showing just a radio input box and allowing you to select/deselect them is not what you needed for all payment options. Some payment methods need different behavior. Also, some payment methods need a separate flow when we perform the "place order" action. To help you out in such cases, Hyvä React Checkout already possesses some superpowers, which we will see in a short time.</p>
<h2 id="payment-supports">Payment Supports</h2>
<p>There are numerous payment service providers (PSP) out there. In a site, we opt one of the PSP by adding its Magento 2 extension and configure it. These PSPs will support many modes of payment methods. Due to this, it will be a cumbersome process to support all the PSPs out there.</p>
<p>Due to the above reason, we are not keeping payment components as part of Hyvä React Checkout. But we will be maintaining separate payment repositories that would support most common PSPs which will hold the custom payment method components which you can use with Hyvä React Checkout seamlessly.</p>
<p>Below, we are listing the payment repositories, and each repository will have specific instructions about its usage.</p>
<ul>
<li>Amazon - <a href="https://github.com/hyva-themes/magento2-react-checkout-amazon-pay">hyva-themes/magento2-react-checkout-amazon-pay</a></li>
<li>MultiSafepay - <a href="https://github.com/MultiSafepay/magento2-hyva-checkout-multisafepay">MultiSafepay/magento2-hyva-checkout-multisafepay</a></li>
<li>Offline payment methods - <a href="https://github.com/hyva-themes/magento2-react-checkout-offline-payments">hyva-themes/magento2-react-checkout-offline-payments</a></li>
<li>Payone - <a href="https://github.com/hyva-themes/magento2-hyva-checkout-payone">hyva-themes/magento2-hyva-checkout-payone</a></li>
<li>Paypal Express - <a href="https://github.com/hyva-themes/magento2-react-checkout-paypal-express">hyva-themes/magento2-hyva-checkout-paypal-express</a></li>
<li>Stripe - <a href="https://github.com/eltrino/magento2-hyva-checkout-stripe">eltrino/magento2-hyva-checkout-stripe</a></li>
<li>Mollie - <a href="https://github.com/MdnAgency/magento2-hyva-checkout-mollie">MdnAgency/magento2-hyva-checkout-mollie</a></li>
</ul>
<p>This is a community effort. So we welcome all of you to help out to grow the above list. The <em>payone</em> repository is an ideal place to look into if you need to create a payment method integration repository.</p>
<hr />
<h2 id="payment-configurations-and-its-usage">Payment Configurations and Its Usage</h2>
<p>Depending upon the payment methods, you may have some special configuration settings in your store. Usually, you do this under <code>Stores &gt; Configuration</code>. If you are familiar with the default Magento 2 checkout page, then you may know that Magento 2 passes this configuration via a global variable which you can find at <code>window.checkoutConfig</code>.</p>
<p>To collect these checkout configurations, we have a ViewModel (<code>Hyva\ReactCheckout\ViewModel\CheckoutConfigProvider</code>) available in the module and we are passing this configuration through the root DOM element.</p>
<p>See the layout file where we injecting the view model.</p>
<p>File: <code>src/view/frontend/layout/hyva_reactcheckout_index.xml</code></p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;page xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; layout=&quot;1column&quot; xsi:noNamespaceSchemaLocation=&quot;urn:magento:framework:View/Layout/etc/page_configuration.xsd&quot;&gt;
    ...
    &lt;body&gt;
        &lt;referenceContainer name=&quot;content&quot;&gt;
            &lt;block
                cacheable=&quot;false&quot;
                name=&quot;checkout.container&quot;
                template=&quot;Hyva_ReactCheckout::react-container.phtml&quot;
            &gt;
                &lt;arguments&gt;
                    &lt;argument
                        name=&quot;checkout_config_provider&quot;
                        xsi:type=&quot;object&quot;&gt;Hyva\ReactCheckout\ViewModel\CheckoutConfigProvider&lt;/argument&gt;
                &lt;/arguments&gt;
            &lt;/block&gt;
        &lt;/referenceContainer&gt;
        ...
    &lt;/body&gt;
&lt;/page&gt;
</code></pre>
<p>See the data attribute <code>data-checkout_configuration</code> through which we are passing this configuration.</p>
<pre><code>File: `src/view/frontend/templates/react-container.phtml`


    &lt;?php
    ...
    /** @var \Magento\Framework\Escaper $escaper */
    /** @var \Hyva\ReactCheckout\ViewModel\CheckoutConfigProvider $configProvider */
    $configProvider = $block-&gt;getCheckoutConfigProvider();
    ...
    ?&gt;
    &lt;div
        id="react-checkout"
        ...
        data-checkout_config="&lt;?= $escaper-&gt;escapeHtmlAttr($configProvider-&gt;getConfig())  ?&gt;"
    &gt;
    ...
    &lt;/div&gt;
</code></pre>
<p>Now the react app has access to the payment configurations, and it can be used in the application according to your need.</p>
<h2 id="custom-payment-renderer">Custom Payment Renderer</h2>
<p>As already stated, by default, all payment methods appear as a radio input. But Hyvä React Checkout allows using a custom renderer for any payment methods.</p>
<p>You can either develop your own custom payment renderer within the <code>reactapp</code>or use an existing custom payment renderer repo within Hyvä React Checkout.</p>
<h4 id="how-to-create-my-own-custom-payment-renderer">How To Create My Own Custom Payment Renderer</h4>
<p>Lets say we want to create a custom payment renderer for paypal-express solution. This is how you do this in Hyvä React Checkout.</p>
<p>Create following folders/ files in <code>src/reactapp/src/paymentMethods</code></p>
<pre><code>src/reactapp/src/paymentMethods/
|
|____paypalExpress/
    |
    |____renderers.js
    |
    |____src/components/PaypalExpress.jsx
</code></pre>
<p>You need at least two files in order to properly create a custom payment renderer.</p>
<ol>
<li>The custom payment render component. This is a react component. This react component will be used to render the payment method. In the shown example <code>src/components/PaypalExpress.jsx</code> is what out custom payment renderer component.</li>
<li>
<p><code>renderers.js</code> file that configures the payment renderer component. The content of this file somewhat looks like below</p>
<p>File: <code>src/reactapp/src/paymentMethods/paypalExpress/renderers.js</code></p>
<pre><code>import PaypalExpress from './src/components/PaypalExpress';

export default {
  paypal_express: PaypalExpress,
};
</code></pre>
<p>So it exports an object. Each key specifies the payment method code (<code>paypal_express</code>) and its value is the custom payment render component (<code>PaypalExpress</code>).</p>
</li>
</ol>
<h4 id="how-to-use-a-custom-payment-renderer-repo-with-hyva-react-checkout">How To Use A Custom Payment Renderer Repo With Hyvä React Checkout</h4>
<p>You need to specify your custom payment repo in the <code>package.json</code> file as shown below:</p>
<p>File: <code>src/reactapp/package.json</code></p>
<pre><code>&quot;config&quot;: {
    &quot;paymentMethodsRepo&quot;: {
        &quot;payone&quot;: &quot;git@github.com:hyva-themes/magento2-hyva-checkout-payone.git&quot;
    }
},
</code></pre>
<p>As you can see above, we are configuring <code>payone</code> custom payment solution under <code>config.paymentMethodsRepo</code>. With this change in your <code>package.json</code> and if you run <code>npm install</code>, then your repo will be cloned into <code>src/reactapp/src/paymentMethods</code> directory and properly configured over there.</p>
<h3 id="how-custom-payment-renderer-works">How Custom Payment Renderer Works</h3>
<p>It all starts from the react component <code>&lt;PaymentMethodMemorized /&gt;</code>. This component is responsible for showing the entire payment method section. See its implementation</p>
<p>File: <code>src/reactapp/src/components/paymentMethod/PaymentMethodMemorized.jsx</code></p>
<pre><code>import React, { useEffect, useState } from 'react';
...
import customRenderers from '../../paymentMethods/customRenderers';

const PaymentMethodMemorized = React.memo(({ formikData }) =&gt; {
  ...
  return (
    &lt;PaymentMethodFormManager formikData={formikData}&gt;
      &lt;Card classes={isPaymentAvailable ? '' : 'opacity-75'}&gt;
        &lt;ToggleBox show title={__('Payment Methods')}&gt;
          {isPaymentAvailable ? (
            &lt;PaymentMethodList methodRenderers={customRenderers} /&gt;
          ) : (
            &lt;NoPaymentMethodInfoBox /&gt;
          )}
        &lt;/ToggleBox&gt;
      &lt;/Card&gt;
    &lt;/PaymentMethodFormManager&gt;
  );
}

export default PaymentMethodMemorized;
</code></pre>
<p>Here <code>customRenderers</code> holds all the custom payment renderers available. This value is an object where its keys will be payment method code and values will be renderer component. <code>renderers</code> state is then passing to <code>&lt;PaymentMethodList /&gt;</code> component. This component will loop through each payment method and if a custom payment renderer defined for a payment, then it will use that custom payment renderer for that payment method; else, it will render the payment method as radio button (default behaviour).</p>
<p><code>customRenderers</code> object which is coming from the file <code>src/paymentMethods/customRenderers.js</code> is an auto-generated file. This file is updated when you have custom payment renderer repositories setup in your <code>package.json</code> file and you perform the installation <code>npm install</code>. The chance to alter this file happens only in those situations where you have your own custom payment renderers and you want to make them available in the payment method section. In that case, you need to manually add your custom payment renderer in that file.</p>
<h4 id="how-custom-payment-renderer-interacts-on-place-order-action">How Custom Payment Renderer Interacts on Place Order Action</h4>
<p>If your payment method needs to alter the behaviour of place order action, then Hyvä React Checkout provides some features out of the box to help you out.</p>
<p>File: <code>src/reactapp/src/context/Form/CheckoutFormProvider.jsx</code></p>
<pre><code>...
function CheckoutFormProvider({ children }) {
  ...
  const [paymentActionList, setPaymentActions] = useState({});
  ...
  const registerPaymentAction = useCallback(
    (paymentMethodCode, paymentMethodAction) =&gt; {
      setPaymentActions(actions =&gt; ({
        ...actions,
        [paymentMethodCode]: paymentMethodAction,
      }));
    },
    [setPaymentActions]
  );
  ...
}
...
</code></pre>
<p>Here <code>CheckoutFormProvider</code> is one of the super parent components that wraps react app. As you can see in the code it has a state <code>paymentActionList</code> which can be populated with any custom payment action you want to perform when the "place order" action happens. See the <code>registerPaymentAction</code> function. This function is available for all the child components and thus a custom payment method component can use it to register a custom "place order" behaviour.</p>
<p>Suppose you have a custom payment method component <code>PayOneCreditCard</code> and it looks like below</p>
<pre><code>function PayOneCreditCard({ method, selected, actions }) {
  const { registerPaymentAction } = useCheckoutFormContext();

  // custom &quot;place order&quot; submit action
  const paymentSubmitHandler = useCallback(
    async values =&gt; {
      console.log({ values });
      alert('yeeeha');
    },
    []
  );

  // registering custom &quot;place order&quot; action for the payment method
  useEffect(() =&gt; {
    registerPaymentAction('payone_creditcard', paymentSubmitHandler);
  }, [registerPaymentAction, paymentSubmitHandler]);

  return (
    // custom payment method JSX here
  );
}
</code></pre>
<p>So in the <code>useEffect</code>, we are registering custom place order action for the payment method. Now when the user opted <code>payone_creditcard</code> as the payment option and then click on the "Place Order" button, it will use the <code>paymentSubmitHandler</code> in this component to process the order. So now the payment method needs to convert the quote to order according to its need and then redirect the user to the success page.</p>
<h3 id="custom-payment-method-best-practices">Custom Payment Method Best Practices</h3>
<ol>
<li>
<p>Define dedicated custom hooks for accessing global states such as <code>App</code>, <code>Cart</code> or <code>Form</code> within the payment method itself. There are hooks available in other places to get the global state. But, it is always better stay away from those custom hooks and define and use dedicated custom hooks within the payment method.</p>
<p>So if you want to get an <code>App</code> action such as <code>setPageLoader</code> within your payment method, then your can do the following to retrieve it.</p>
<p>File: <code>src/reactapp/src/paymentMethods/&lt;yourPaymentMethod&gt;/src/hooks/usePayOneAppContext.js</code></p>
<pre><code>import { useContext } from 'react';

import AppContext from '../../../../context/App/AppContext';

export default function usePayOneAppContext() {
  const [, { setPageLoader }] = useContext(AppContext);

  return {
    setPageLoader,
  };
}
</code></pre>
<p>Now use <code>usePayOneAppContext</code> hook inside your <code>yourPaymentMethod</code>.</p>
</li>
<li>
<p>Define your custom API methods within the payment method itself.</p>
<p>Hyvä React Checkout holds all of its api methods inside <code>src/reactapp/src/api/</code> directory. The components does not use any api methods defined here directly. Instead we are passing them through <code>AppContext</code> or <code>CartContext</code>. So if an API method needed in your payment method is already defined in the app, then access them through the corresponding context and use it with your payment method.</p>
<p>But in some cases, your payment method needs to use its own custom api methods. In this case, it should be defined inside <code>src/reactapp/src/paymentMethods/&lt;yourPaymentMethod&gt;/src/api/</code> directory. When you define your custom API methods, it will be good to follow the conventions we already using in <code>src/reactapp/src/api/</code>.</p>
<p>You can use your custom API methods directly inside the components. No need to setup a context and passing the api method through that context. But if your payment method is so complicated and you need a context layer to manage it effectively, then feel free to adopt that approach too.</p>
</li>
<li>
<p>Most of the custom payment methods need to provide custom data as part of placing the order. In the Luma checkout, they send this extra information either via <code>additional_data</code> and/or via <code>extension_attributes</code> which are part of REST API method <code>save-payment</code>. In order to replicate the same in Hyvä React Checkout, it is vital to rely on the above REST API method. So there is a general hook <code>src/reactapp/src/hook/usePerformPlaceOrderByREST.js</code> available and it can be handy in payment integration in order to place an order.</p>
</li>
</ol>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../i18n/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Internationalization" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Internationalization
            </div>
          </div>
        </a>
      
      
        
        <a href="../env_variables/" class="md-footer__link md-footer__link--next" aria-label="Next: React app configurations" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              React app configurations
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>